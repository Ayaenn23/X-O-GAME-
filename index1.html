<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tic Tac Toe</title>
    <link rel="stylesheet" href="style1.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
  </head>
  <body>
    <!-- Page 1 - Main Menu -->
    <div id="page1" class="page active">
      <div class="top-icons">
        <div class="settings-wrapper">
          <i class="fas fa-user user-icon" id="userIcon"></i>
          <i class="fas fa-cog settings-icon" id="settingsIcon"></i>
        </div>
      </div>
      <h1 class="game-title" data-translate="gameTitle">Tic Tac Toe</h1>
      <div class="bouton">
        <button class="play-button" id="playButton">
          <i class="fas fa-play"></i> <span data-translate="play">Play</span>
        </button>
        <button class="btn-onlin">
          <a href="index2.html"><span data-translate="online">Online</span></a>
        </button>
      </div>
    </div>

    <!-- Page 2 - Difficulty Selection -->
    <div id="page2" class="page">
      <div class="top-icons">
        <div class="settings-wrapper">
          <i class="fas fa-user user-icon" id="userIcon2"></i>
          <i class="fas fa-cog settings-icon" id="settingsIcon2"></i>
        </div>
      </div>
      <h2 data-translate="selectDifficulty">Select Difficulty</h2>
      <div class="difficulty-buttons">
        <button class="difficulty-btn" id="easyBtn" data-translate="easy">
          Easy
        </button>
        <button class="difficulty-btn" id="mediumBtn" data-translate="medium">
          Medium
        </button>
        <button class="difficulty-btn" id="hardBtn" data-translate="hard">
          Hard
        </button>
      </div>
    </div>

    <!-- Page 3 - Easy Mode Selection -->
    <div id="page3" class="page">
      <div class="top-icons">
        <div class="settings-wrapper">
          <i class="fas fa-user user-icon" id="userIcon3"></i>
          <i class="fas fa-cog settings-icon" id="settingsIcon3"></i>
        </div>
      </div>
      <h2 data-translate="selectMode">Select Game Mode</h2>
      <div class="mode-buttons">
        <button class="mode-btn" id="vsRobotEasy" data-translate="vsRobot">
          VS Robot
        </button>
        <button class="mode-btn" id="vsPlayerEasy" data-translate="vsPlayer">
          2 Players
        </button>
      </div>
    </div>

    <!-- Page 4 - Medium/Hard Mode Selection -->
    <div id="page4" class="page">
      <div class="top-icons">
        <div class="settings-wrapper">
          <i class="fas fa-user user-icon" id="userIcon4"></i>
          <i class="fas fa-cog settings-icon" id="settingsIcon4"></i>
        </div>
      </div>
      <h2 data-translate="selectMode">Select Game Mode</h2>
      <div class="mode-buttons">
        <button class="mode-btn" id="vsRobotMedium" data-translate="vsRobot">
          VS Robot
        </button>
        <button class="mode-btn" id="vsPlayerMedium" data-translate="vsPlayer">
          2 Players
        </button>
        <button class="mode-btn" id="vs3Players" data-translate="vs3Players">
          3 Players
        </button>
        <button class="mode-btn" id="vs4Players" data-translate="vs4Players">
          4 Players
        </button>
      </div>
    </div>

    <!-- Page 5 - Game Board (3x3) -->
    <div id="page5" class="page">
      <div class="game-header">
        <div class="game-info">
          <div class="score-display">
            <span id="player1Score">Player 1: 0</span>
            <span id="player2Score">Player 2: 0</span>
            <span id="player3Score" class="hidden">Player 3: 0</span>
            <span id="player4Score" class="hidden">Player 4: 0</span>
          </div>
          <div class="current-player" id="currentPlayer">
            Current: Player 1 (X)
          </div>
        </div>
        <div class="settings-wrapper">
          <i class="fas fa-user user-icon" id="userIcon5"></i>
          <i class="fas fa-cog settings-icon" id="settingsIcon5"></i>
        </div>
      </div>

      <div class="game-container">
        <div class="game-board" id="gameBoard3x3">
          <!-- 3x3 Cells will be generated by JavaScript -->
        </div>
      </div>

      <button class="back-button" id="backButton">
        <i class="fas fa-arrow-left"></i>
        <span data-translate="backToMenu">Back to Menu</span>
      </button>
    </div>

    <!-- Page 6 - Game Board (4x4) -->
    <div id="page6" class="page">
      <div class="game-header">
        <div class="game-info">
          <div class="score-display">
            <span id="player1Score4x4">Player 1: 0</span>
            <span id="player2Score4x4">Player 2: 0</span>
            <span id="player3Score4x4">Player 3: 0</span>
            <span id="player4Score4x4">Player 4: 0</span>
          </div>
          <div class="current-player" id="currentPlayer4x4">
            Current: Player 1 (X)
          </div>
        </div>
        <div class="settings-wrapper">
          <i class="fas fa-user user-icon" id="userIcon6"></i>
          <i class="fas fa-cog settings-icon" id="settingsIcon6"></i>
        </div>
      </div>

      <div class="game-container">
        <div class="game-board" id="gameBoard4x4">
          <!-- 4x4 Cells will be generated by JavaScript -->
        </div>
      </div>

      <button class="back-button" id="backButton4x4">
        <i class="fas fa-arrow-left"></i>
        <span data-translate="backToMenu">Back to Menu</span>
      </button>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2 data-translate="settings">Settings</h2>
        <div class="settings-option">
          <label data-translate="sound">Sound:</label>
          <label class="switch">
            <input type="checkbox" id="soundToggle" checked />
            <span class="slider round"></span>
          </label>
        </div>
        <div class="settings-option">
          <label data-translate="music">Music:</label>
          <label class="switch">
            <input type="checkbox" id="musicToggle" checked />
            <span class="slider round"></span>
          </label>
        </div>
        <div class="settings-option">
          <label data-translate="theme">Theme:</label>
          <label class="switch">
            <input type="checkbox" id="themeToggle" />
            <span class="slider round"></span>
          </label>
          <span id="themeLabel">Light</span>
        </div>
        <div class="settings-option">
          <label data-translate="language">Language:</label>
          <select id="languageSelect">
            <option value="en">English</option>
            <option value="fr">Français</option>
            <option value="ar">العربية</option>
          </select>
        </div>
      </div>
    </div>

    <!-- User Modal (Connexion) -->
    <div id="userModal" class="modal1">
      <div class="modal-content1 user-modal-content">
        <span class="close-btn" id="closeUserModal">&times;</span>
        <div class="form-container">
          <h2 data-translate="register">Register</h2>
          <form id="registerForm">
            <input type="text" placeholder="Name" id="name" required />
            <input type="email" placeholder="Email" id="email" required />
            <input
              type="password"
              placeholder="Password"
              id="password"
              required
            />
            <button
              type="submit"
              class="btn inscrire-btn"
              data-translate="registerBtn"
            >
              Register
            </button>
          </form>
        </div>
        <div class="social-buttons">
          <button class="btn facebook-btn">
            <i class="fab fa-facebook-f"></i>
            <span data-translate="loginWithFacebook" id="facebookLoginBtn"
              >Login with Facebook</span
            >
          </button>

          <button class="btn google-btn">
            <i class="fab fa-google"></i>
            <span data-translate="loginWithGoogle">Login with Google</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal">
      <div class="modal-content game-over-content">
        <h2 id="gameOverTitle">Game Over</h2>
        <div id="gameOverMessage"></div>
        <div id="gameEmoji" class="game-emoji"></div>
        <div class="game-over-buttons">
          <button id="playAgainButton" data-translate="playAgain">
            Play Again
          </button>
          <button id="backToMenuButton" data-translate="backToMenu">
            Back to Menu
          </button>
        </div>
      </div>
    </div>

    <!-- Win Message Overlay -->
    <div id="winMessage" class="win-message hidden">
      <h2 id="winText">Player 1 Wins!</h2>
      <button id="playAgainButton" class="play-again-btn">Play Again</button>
    </div>

    <!-- Audio elements -->
    <audio id="backgroundMusic" loop>
      <source src="sounds/audio.mp3" type="audio/mpeg" />
    </audio>
    <audio id="clickSound" src="sounds/click.mp3" preload="auto"></audio>
    <audio id="winSound" src="sounds/winne.mp3" preload="auto"></audio>
    <audio id="victorySound" src="sounds/winne.mp3" preload="auto"></audio>
    <audio id="drawSound" src="sounds/draw.mp3" preload="auto"></audio>
    <audio id="defeatSound" src="sounds/fail.mp3" preload="auto"></audio>

    <canvas id="confettiCanvas" class="hidden"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/confetti-js@0.0.17/dist/index.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <!-- Firebase SDK -->
    <script type="module">
      // Import des fonctions Firebase
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
      import {
        getAuth,
        signInWithPopup,
        GoogleAuthProvider,
        FacebookAuthProvider,
        onAuthStateChanged,
      } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js";

      // Ta configuration Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyB4WtmzgI-Ue8xWpdglgQ3etHSKJ2R4QRo",
        authDomain: "tic-tac-toe-online-b3366.firebaseapp.com",
        databaseURL:
          "https://tic-tac-toe-online-b3366-default-rtdb.firebaseio.com",
        projectId: "tic-tac-toe-online-b3366",
        storageBucket: "tic-tac-toe-online-b3366.firebasestorage.app",
        messagingSenderId: "600108456209",
        appId: "1:600108456209:web:243eca35089be054a2d4b0",
        measurementId: "G-P6FMSCZ2M4",
      };

      // Initialisation
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const googleProvider = new GoogleAuthProvider();
      const facebookProvider = new FacebookAuthProvider();

      // Gestion des connexions
      document.querySelector(".google-btn").addEventListener("click", () => {
        signInWithPopup(auth, googleProvider)
          .then((result) => {
            console.log("Connecté avec Google:", result.user);
            document.getElementById("userModal").style.display = "none";
          })
          .catch((error) => {
            alert("Erreur Google: " + error.message);
          });
      });

      document.querySelector(".facebook-btn").addEventListener("click", () => {
        signInWithPopup(auth, facebookProvider)
          .then((result) => {
            console.log("Connecté avec Facebook:", result.user);
            document.getElementById("userModal").style.display = "none";
          })
          .catch((error) => {
            alert("Erreur Facebook: " + error.message);
          });
      });

      // Gestion de l'état de connexion
      onAuthStateChanged(auth, (user) => {
        const userIcons = document.querySelectorAll(".user-icon");
        userIcons.forEach((icon) => {
          icon.classList.toggle("fa-user-check", !!user);
          icon.classList.toggle("fa-user", !user);
        });
      });

      // Fermeture du modal
      document
        .getElementById("closeUserModal")
        .addEventListener("click", () => {
          document.getElementById("userModal").style.display = "none";
        });
    </script>

    <script src="script1.js"></script>
  </body>
</html>